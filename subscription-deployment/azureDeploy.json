{
  "properties":
    {
	    "location": "westus",
	    "properties": {
		    "template": {
			    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
			    "contentVersion": "1.0.0.0",
			    "parameters": {},
			    "variables": {
				    "uniqueAliasName": "sampleAlias"
			    },
			    "resources": [
				    {
					    "type": "Microsoft.Resources/deployments",
					    "apiVersion": "2019-10-01",
					    "name": "sampleTemplate",
					    "location": "westus",
					    "properties": {
						    "expressionEvaluationOptions": {
							    "scope": "inner"
						    },
						    "mode": "Incremental",
						    "template": {
							      "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
							    "contentVersion": "1.0.0.0",
							    "variables": {
								    "uniqueAliasName": "sampleAlias"
							    },
							    "resources": [
								    {
									    "name": "[variables('uniqueAliasName')]",
									    "type": "Microsoft.Subscription/aliases",
									    "apiVersion": "2020-09-01",
									    "properties": {
										    "workLoad": "Production",
										    "displayName": "Dev Team subscription",
										    "billingScope": "/providers/Microsoft.Billing/billingAccounts/5e98e158-xxxx-xxxx-xxxx-xxxxxxxxxxxx:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx_xxxx-xx-xx/billingProfiles/AW4F-xxxx-xxx-xxx/invoiceSections/SH3V-xxxx-xxx-xxx"
									    },
									    "dependsOn": [],
									    "tags": {}
								    }
							    ],
							    "outputs": {
								    "subscriptionId": {
									    "type": "string",
									    "value": "[replace(reference(variables('uniqueAliasName')).subscriptionId, 'invalidrandom/', '')]"
								    }
							    }
						    }
					    }
				    },
				    {
					    "name": "sampleOuterResource",
					    "type": "Microsoft.Resources/deployments",
					    "apiVersion": "2019-10-01",
					    "location": "westus",
					    "properties": {
						    "expressionEvaluationOptions": {
							    "scope": "inner"
						    },
						    "mode": "Incremental",
						    "parameters": {
							    "subscriptionId": {
								    "value": "[reference('sampleTemplate').outputs.subscriptionId.value]"
							    }
						    },
						    "template": {
							    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
							"contentVersion": "1.0.0.0",
							    "parameters": {
								    "subscriptionId": {
									    "type": "string"
								    }
							    },
							    "variables": {},
							    "resources": [
								    {
									    "name": "sampleInnerResource",
									    "type": "Microsoft.Resources/deployments",
									    "subscriptionId": "[parameters('subscriptionId')]",
									    "apiVersion": "2019-10-01",
									    "location": "westus",
									    "properties": {
										    "expressionEvaluationOptions": {
											    "scope": "inner"
										    },
										    "mode": "Incremental",
										    "parameters": {},
										    "template": {
											    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
											    "contentVersion": "1.0.0.0",
											    "parameters": {},
											    "variables": {},
											    "resources": [
												    {
													    "type": "Microsoft.Resources/resourceGroups",
													    "apiVersion": "2020-05-01",
													    "location": "[deployment().location]",
													    "name": "sampleRG",
													    "properties": {},
													    "tags": {}
												    }
											    ],
											    "outputs": {}
										    }
									    }
								    }
							    ],
							    "outputs": {}
						    }
					    }
				    }
			    ],
			    "outputs": {
				    "messageFromLinkedTemplate": {
					    "type": "string",
					    "value": "[reference('sampleTemplate').outputs.subscriptionId.value]"
				    }
			    }
		    },
		    "mode": "Incremental"
	    }
    }
}